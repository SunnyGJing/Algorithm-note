"""
Creat time: 2019-07-27 22:53
Last modified time: 

请问机器人能够到达多少个格子？机器人从(0,0)出发，不能踩下标的数位之和大于threshold的格子。
例如，当k为18时，机器人不能进入方格（35,38），因为3+5+3+8=19。
"""

class Solution {
public:
    int movingCount(int threshold, int rows, int cols) {
        bool *visited = new bool[rows*cols];
        memset(visited, false, rows*cols);
        return movingCountCore(0,0,threshold,rows,cols,visited);        
    }

    int movingCountCore(int row, int col, int threshold, int rows,
        int cols, bool* &visited)
    {
        int sum = addByBit(row, col);
        if(row<0 || row>=rows || col<0 || col>=cols || sum>threshold || visited[row*cols+col]==true)
            return 0;
        int count = 1;
        visited[row*cols+col] = true;
        int direct_i[4] = {-1, 1, 0, 0};
        int direct_j[4] = {0, 0, -1, 1};
        for(int n=0; n<4; n++) {
            int cur_i = row + direct_i[n];
            int cur_j = col + direct_j[n];
            count += movingCountCore(cur_i,cur_j,threshold,rows,cols,visited);
        }
        return count;
    }

    int addByBit(int row, int col) {
        int result = 0;
        while(row > 0) {
            result += row % 10;
            row /= 10;
        }
        while(col > 0) {
            result += col % 10;
            col /= 10;
        }
        return result;
    }
};
